# Friday Ceremony â€” Weekly Ritual
# Free Intelligence â€” Sprint Health & Grooming
# Version: 1.0.0
# Updated: 2025-10-29

friday_ceremony:
  description: "Ritual semanal para cerrar sprint, grooming backlog, actualizar mÃ©tricas"
  frequency: "weekly"
  duration: "30-45 minutes"
  participants: ["owner", "claude_code"]

  steps:
    - step: 1
      name: "Review Done Cards"
      duration: "10 min"
      actions:
        - command: "trello cards 68fc0116622f29eecd78b7d4"
          description: "Listar todas las cards en âœ… Done list"
        - check: "Verificar que todas tienen comentario con evidencia"
        - check: "Confirmar artefactos ejecutables (tools/verify_artifact.py)"
        - metric: "Count Done cards desde Ãºltimo viernes"

    - step: 2
      name: "Update BitÃ¡cora (CLAUDE.md)"
      duration: "5 min"
      actions:
        - command: "Agregar entrada append-only a CLAUDE.md"
          format: |
            YYYY-MM-DD â€” Sprint [NUM] Close
            â€¢ Cards Done: X (P0: Y, P1: Z)
            â€¢ Artefactos creados: [lista]
            â€¢ Velocity: X.XX (actual_hours / estimated_hours)
            â€¢ Blockers resueltos: [lista]
            â€¢ Next sprint focus: [Ã¡rea prioritaria]
        - check: "NO_MD exception vÃ¡lida (CLAUDE.md permitido > 150 lÃ­neas)"

    - step: 3
      name: "Sprint Health Check"
      duration: "10 min"
      actions:
        - command: "trello board-overview 68fbfeeb7f8614df2eb61e42"
          description: "Ver distribuciÃ³n de cards por list"
        - check: "âš™ï¸ In Progress no debe estar vacÃ­o (workflow innegociable)"
        - check: "ğŸ§ª Testing tiene < 5 cards (no bottleneck)"
        - check: "ğŸš€ Sprint tiene 15-20 cards (capacity adecuada)"
        - metric: "Cards aging > 7 dÃ­as sin movimiento"

    - step: 4
      name: "Groom Backlog (Top 10 P0/P1)"
      duration: "15 min"
      actions:
        - command: "trello cards 690100441851396c1cb143a6 | head -15"
          description: "Ver top cards en ğŸ“¥ Backlog"
        - check: "Top 10 P0 tienen labels, due dates, AC claros (DoR)"
        - check: "Dependencies identificadas (blocking cards)"
        - action: "Mover P0 ready â†’ Sprint (si capacity disponible)"
        - action: "Archivar duplicados o stale cards (> 30 dÃ­as sin actividad)"

    - step: 5
      name: "Celebrate Wins"
      duration: "5 min"
      actions:
        - check: "Reconocer logros tÃ©cnicos de la semana"
        - check: "Identificar mejoras en velocity o quality"
        - action: "Git tag para releases importantes (v0.X.0)"

metrics:
  velocity:
    formula: "actual_hours / estimated_hours"
    target: "< 1.2 (over-estimate tolerable, under-estimate no)"
    tracking: "Por sprint (4 sprints por mes)"

  done_rate:
    formula: "Cards Done / Cards Started"
    target: "> 0.80 (80% completion rate)"

  age_in_progress:
    formula: "DÃ­as desde moved to In Progress"
    target: "< 3 dÃ­as (mover a Testing o back to Sprint)"

  test_bottleneck:
    formula: "Cards en Testing > 5"
    action: "Priorizar QA o mover back to In Progress"

automation:
  reminders:
    - trigger: "Viernes 16:00 America/Mexico_City"
      action: "Notify owner: Friday Ceremony time"
    - trigger: "âš™ï¸ In Progress vacÃ­o"
      action: "Alert: Workflow violation â€” mover P0 de Sprint"
    - trigger: "Card en Testing > 48h"
      action: "Review: QA blocker o mover a Done/Sprint"

outputs:
  bitacora_entry: "CLAUDE.md (append-only)"
  metrics_snapshot: "metrics/sprint_[NUM]_[DATE].json"
  backlog_groomed: "Top 10 P0/P1 con DoR completo"
  next_sprint_plan: "ğŸ“¥ Backlog â†’ ğŸš€ Sprint (capacity: 15-20 cards)"
